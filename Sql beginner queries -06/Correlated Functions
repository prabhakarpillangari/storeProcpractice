use Indian_Bank
go
--select acid, name, CBalance, CBalance - (select avg(UBalance) from AccountMaster)
-- from AccountMaster

-- select avg(Cbalance) from AccountMaster

create table chintu
(
name char(1),
sal int)

insert into chintu values('A',20),('B', 30),('D',40),('C',30)
update chintu
set sal = 20
where name ='B'

select name,sal
from chintu
where sal=(select max(sal)
from chintu
where sal <(select  max(sal) from chintu))


--find the second max cbal of the account holder details



select max(cbalance) from AccountMaster
where CBalance < (select max(CBalance) from AccountMaster)


---Find the 10th highest cbal from accountmaster

select name,cbalance from AccountMaster
where CBalance=
(
	select min(cbalance) from AccountMaster
	where CBalance in (
		select  distinct top 10 CBalance from AccountMaster
		order by CBalance desc
)
)



create table empInfo
(
eid int,
empname varchar(40),
sal int,
deptname varchar(40)
)

insert into empinfo values(1,'john',10000,'HR'),(2,'Girish',12000,'Sales'),(3,'Mannat',8000,'Sales'),
(4,'Salman',14000,'HR'),(5,'Ratan',9000,'HR'),(6,'peter',11000,'Sales')

--Find the employees with salary higher than thier department Average


select empname,sal from empInfo
where sal in (
			select avg(sal) from empInfo
			group by deptname
		  )
		  

---------------corelated functions------------

select * from AccountMaster as am
where not  exists (select * from TxnMaster tm 
			  where tm.ACID=am.acid)
